<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Profile — Electro Gang Community</title>
  <style>
    :root{
      --bg:#0f1114; --card:#131617; --accent1:#0072ff; --accent2:#00c6ff; --muted:#a9b4c2; --white:#eef6ff; --radius:12px;
    }
    html,body{height:100%; margin:0; font-family: Arial, sans-serif; background:var(--bg); color:var(--white);}
    .wrap{min-height:100%; display:flex; align-items:center; justify-content:center; padding:28px;}
    .card{ width:420px; max-width:94vw; border-radius:12px; background:linear-gradient(180deg,var(--card), #0f1316);
      box-shadow:0 14px 46px rgba(2,6,23,0.7); padding:22px; text-align:center;
    }
    h2{ margin:6px 0 8px 0; font-size:20px;}
    .muted{ color:var(--muted); font-size:14px; margin-bottom:10px; }
    .xp{ font-size:18px; font-weight:600; margin:12px 0; color:var(--white); }
    .btn{
      background: linear-gradient(135deg,var(--accent1),var(--accent2));
      color:white; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700;
      box-shadow:0 8px 20px rgba(0,114,255,0.14); transition: transform .14s ease;
    }
    .btn:hover{ transform:translateY(-3px); }
    .link-btn{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--white); padding:9px 12px; border-radius:10px; cursor:pointer; }
    .footer{ margin-top:18px; font-size:13px; color:var(--muted); }
    .row{ display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" id="profileCard">
      <!-- content populated by JS -->
    </div>
  </div>

<script>
const USERS_KEY = "eg_users";
const CURRENT_KEY = "eg_currentUser";

/* Storage helpers */
function loadUsers(){
  try { return JSON.parse(localStorage.getItem(USERS_KEY) || "{}"); } catch(e){ return {}; }
}
function saveUsers(obj){ localStorage.setItem(USERS_KEY, JSON.stringify(obj)); }
function getCurrentUser(){ return localStorage.getItem(CURRENT_KEY) || null; }
function setCurrentUser(u){ if(u) localStorage.setItem(CURRENT_KEY, u); else localStorage.removeItem(CURRENT_KEY); }

/* addXP (silent) */
function addXP(amount = 10){
  const cur = getCurrentUser();
  if(!cur) return false;
  const users = loadUsers();
  if(!users[cur]) users[cur] = { password: "", xp: 0 };
  users[cur].xp = (Number(users[cur].xp) || 0) + Number(amount);
  saveUsers(users);
  renderProfile(); // update UI silently
  return true;
}

/* logout */
function logout(){
  setCurrentUser(null);
  renderProfile();
}

/* render profile UI depending on login state */
function renderProfile(){
  const container = document.getElementById("profileCard");
  const cur = getCurrentUser();
  const users = loadUsers();

  if(cur && users[cur]){
    const xp = Number(users[cur].xp || 0);
    container.innerHTML = `
      <h2>Welcome, ${escapeHtml(cur)}!</h2>
      <div class="muted">Your Electro Gang profile</div>
      <div class="xp">Total XP: ${xp}</div>
      <div class="row">
        <button class="btn" onclick="addXP(); window.location.href='leaderboard.html'">View Leaderboard</button>
        <button class="btn" onclick="addXP(); window.location.href='index.html'">Home</button>
      </div>
      <div class="row">
        <button class="btn" onclick="addXP(); logout()">Log Out</button>
      </div>
      <div class="footer">© Electro Gang Community. All rights reserved.</div>
    `;
  } else {
    container.innerHTML = `
      <h2>Not signed in</h2>
      <div class="muted">You are not logged in. Create an account or sign in to view your profile and earn XP.</div>
      <div class="row">
        <button class="btn" onclick="window.location.href='login.html'">Sign Up / Log In</button>
        <button class="btn" onclick="window.location.href='index.html'">Home</button>
      </div>
      <div class="footer">© Electro Gang Community. All rights reserved.</div>
    `;
  }
}

/* escape */
function escapeHtml(s){ return (s+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); }

/* init */
(function init(){
  const cur = getCurrentUser();
  if(cur){
    const users = loadUsers();
    if(!users[cur]){
      users[cur] = { password: "", xp: 0 };
      saveUsers(users);
    }
  }
  renderProfile();
})();
</script>
</body>
</html>
